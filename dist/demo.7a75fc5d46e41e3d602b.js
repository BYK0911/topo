!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),s=n(10),a=function(t){function e(){var e=t.call(this)||this;return e.type="TopoBlock",e.x=0,e.y=0,e.width=0,e.height=0,e.rotation=0,e.scale=1,e}return r(e,t),e.prototype.contain=function(t,e){var n=this.width,o=this.height;return t>=0&&t<=n&&e>=0&&e<=o},e.prototype.translate=function(t,e){this.x+=t,this.y+=e},e.prototype.rotate=function(t){this.rotation=(this.rotation+t)%360},e.prototype.zoom=function(t){this.scale*=t?1.1:1/1.1},e.prototype.getRelativeCoord=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var n=new s.default(t,e);return n.translate(-this.x,-this.y),n.scale(1/this.scale,1/this.scale),n.rotate(-this.rotation),n},e.prototype.getAbsoluteCoord=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var n=new s.default(t,e);return n.rotate(this.rotation),n.scale(this.scale,this.scale),n.translate(this.x,this.y),n},e}(i.default);e.default=a},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),s=n(2),a=function(t){function e(){var e=t.call(this)||this;return e.type="TopoEdge",e.points=[],e.lineDash=[0],e.lineWidth=1,e.color="#666",e}return r(e,t),e.prototype.render=function(t){t.beginPath(),this.points.forEach((function(e,n){0===n?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)})),t.setLineDash(this.lineDash),t.lineWidth=this.lineWidth,t.strokeStyle=this.color,t.stroke(),t.closePath()},e.prototype.contain=function(t,e){var n=this.points[0],o=n.x,r=n.y,i=this.points[this.points.length-1],a=i.x,u=i.y;return s.default(o,r,a,u,t,e)},e}(i.default);e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(11);e.default=function(t,e,n,r,i,s){var a=[n-t,r-e],u=[i-t,s-e],c=o.default.norm(a);return o.default.norm(u)<=2||!!(c&&o.default.crossNorm(a,u)/c<=2)}},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),s=0,a=function(t){function e(){var e=t.call(this)||this;return e.id="TopoElement_"+s++,e.type="TopoElement",e.root=null,e.parent=null,e.visible=!0,e}return r(e,t),e.prototype.render=function(t){},e.prototype.contain=function(t,e){return!1},e.prototype.show=function(){this.visible=!0},e.prototype.hide=function(){this.visible=!1},e}(i.default);e.default=a},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.type="TopoGroup",e.elements=[],e}return r(e,t),e.prototype.render=function(t){t.save(),t.translate(this.x,this.y),t.rotate(this.rotation/180*Math.PI),t.scale(this.scale,this.scale),this.elements.forEach((function(e){return e.render(t)})),t.restore()},e.prototype.contain=function(t,e){var n=this.x,o=this.y,r=this.width,i=this.height;return t>=n&&t<=n+r&&e>=o&&e<=o+i},e.prototype.add=function(t){this.elements.includes(t)||(t.parent=this,t.root=this.root||this,this.elements.push(t))},e.prototype.remove=function(t){var e=this.elements.indexOf(t);e>-1&&(this.elements.splice(e,1),t.parent=null,t.root=null)},e.prototype.clear=function(){this.elements.forEach((function(t){t.parent=null,t.root=null})),this.elements=[]},e}(n(0).default);e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(6)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(7),r=o.default.init();r.rotate(15),r.translate(300,0),r.resize(window.innerWidth,window.innerHeight),document.body.style.margin="0",document.body.appendChild(r.canvas);!function(t,e){var n=[],i={};t.forEach((function(t){var e=new o.default.TopoNode;Object.assign(e,t),n.push(e),i[t.id]=e})),e.forEach((function(t){var e=new o.default[t.type];e.lineWidth=t.lineWidth,e.lineDash=t.lineDash,e.color=t.color,t.points.forEach((function(t){var n={};Object.defineProperties(n,{x:{get:function(){return i[t].getAbsoluteCoord().x}},y:{get:function(){return i[t].getAbsoluteCoord().y}}}),e.points.push(n)})),r.add(e)})),n.forEach((function(t){return r.add(t)}))}([{type:"TopoNode",id:"0",x:100,y:100},{type:"TopoNode",id:"1",x:200,y:100},{type:"TopoNode",id:"2",x:300,y:100},{type:"TopoNode",id:"3",x:400,y:100},{type:"TopoNode",id:"4",x:300,y:200},{type:"TopoNode",id:"5",x:400,y:200},{type:"TopoNode",id:"6",x:500,y:200}],[{type:"TopoEdge",points:["1","4"],lineWidth:1,color:"#333",lineDash:[0]},{type:"TopoZEdge",points:["2","5"],lineWidth:1,color:"#333",lineDash:[5,5]},{type:"TopoSEdge",points:["3","6"],lineWidth:1,color:"#fa5",lineDash:[0]}]),console.log(r),function t(){window.requestAnimationFrame(t),r.render()}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(8),r=n(1),i=n(12),s=n(13),a=n(14),u={TopoNode:o.default,TopoEdge:r.default,TopoZEdge:i.default,TopoSEdge:s.default,init:function(){var t=new a.default,e=0,n=0;return t.on("mousewheel",(function(e){var n=e.originalEvent,o=n.wheelDelta||n.detail,r=t.scale;t.zoom(o>0),t.translate(e.x/t.scale-e.x/r,e.y/t.scale-e.y/r)})),t.on("dragstart",(function(t){t.stopPropagation(),e=t.originalEvent.offsetX,n=t.originalEvent.offsetY})),t.on("drag",(function(t){var o,r;if(t.stopPropagation(),t.target.parent){var i=t.target.parent.getRelativeCoord(e,n),s=i.x,a=i.y,u=t.target.parent.getRelativeCoord(t.originalEvent.offsetX,t.originalEvent.offsetY);o=u.x-s,r=u.y-a}else o=t.originalEvent.offsetX-e,r=t.originalEvent.offsetY-n;t.target.translate(o,r),e=t.originalEvent.offsetX,n=t.originalEvent.offsetY})),t}};e.default=u},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.type="TopoNode",e.width=50,e.height=50,e}return r(e,t),e.prototype.render=function(t){var e=this.x,n=this.y,o=this.width,r=this.height;e-=o/2,n-=r/2,t.save(),t.translate(e,n),t.rotate(this.rotation/180*Math.PI),t.scale(this.scale,this.scale),t.fillStyle="#fa5",t.fillRect(0,0,o,r),t.restore()},e.prototype.contain=function(t,e){var n=this.width,o=this.height;return t>=-n/2&&t<=n/2&&e>=-o/2&&e<=o/2},e}(n(0).default);e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=new WeakMap,r=function(t,e,n){var r,i=o.has(t);return i&&(i=(r=o.get(t)[e])&&r.includes(n)),i},i=function(t,e,n){var r;o.has(t)?r=o.get(t):(r={},o.set(t,r)),r[e]=r[e]||[],r[e].push(n)},s=function(t,e,n){if(e)if(n){var r=o.get(t)[e],i=r.indexOf(n);i>-1&&r.splice(i,1)}else o.get(t)[e]=[];else o.delete(t)},a=function(t,e){return o.has(t)?o.get(t)[e]:null},u=function(){function t(){}return t.prototype.on=function(t,e){r(this,t,e)||i(this,t,e)},t.prototype.off=function(t,e){s(this,t,e)},t.prototype.dispatch=function(t){var e=this,n=a(this,t.type);n&&n.forEach((function(n){return n.call(e,t)}))},t}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.matrix=function(t,e,n,o,r,i){var s=this.x,a=this.y;return this.x=t*s+e*a+n,this.y=o*s+r*a+i,this},t.prototype.translate=function(t,e){return this.matrix(1,0,t,0,1,e)},t.prototype.scale=function(t,e){return this.matrix(t,0,0,0,e,0)},t.prototype.rotate=function(t){t=t/180*Math.PI;var e=Math.cos(t),n=Math.sin(t);return this.matrix(e,-n,0,n,e,0)},t.prototype.skewX=function(t){t=t/180*Math.PI;var e=Math.tan(t);return this.matrix(1,e,0,0,1,0)},t.prototype.skewY=function(t){t=t/180*Math.PI;var e=Math.tan(t);return this.matrix(1,0,0,e,1,0)},t}();e.default=o},function(t,e,n){"use strict";var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o};Object.defineProperty(e,"__esModule",{value:!0});var r={add:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=[];return t.forEach((function(t){t.forEach((function(t,e){n[e]=n[e]?n[e]+t:t}))})),n},deduct:function(t,e){var n=o(t);return e.forEach((function(t,e){n[e]=(n[e]||0)-t})),n},norm:function(t){if(0!==t.length)return Math.pow(t.reduce((function(t,e){return t+e*e}),0),1/t.length)},dot:function(t,e){for(var n=Math.min(t.length,e.length),o=0,r=-1;++r<n;)o+=t[r]*e[r];return o},crossNorm:function(t,e){return Math.abs(t[0]*e[1]-t[1]*e[0])},multiply:function(t,e){return t.map((function(t){return t*e}))},cos:function(t,e){return this.dot(t,e)/this.norm(t)/this.norm(e)},angle:function(t,e){return Math.acos(this.cos(t,e))}};e.default=r},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),s=n(2),a=function(t){function e(){var e=t.call(this)||this;return e.type="TopoZEdge",e}return r(e,t),e.prototype.render=function(t){var e=this.points,n=e[0],o=n.x,r=n.y,i=e[1],s=i.x,a=i.y;t.beginPath(),t.moveTo(o,r),t.lineTo((o+s)/2,r),t.lineTo((o+s)/2,a),t.lineTo(s,a),t.setLineDash(this.lineDash),t.lineWidth=this.lineWidth,t.strokeStyle=this.color,t.stroke(),t.closePath()},e.prototype.contain=function(t,e){for(var n=this.points[0],o=n.x,r=n.y,i=this.points[this.points.length-1],a=i.x,u=i.y,c=(o+a)/2,f=[[o,r],[c,r],[c,u],[a,u]],l=-1;++l<3;)if(s.default(f[l][0],f[l][1],f[l+1][0],f[l+1][1],t,e))return!0;return!1},e}(i.default);e.default=a},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),s=n(2),a=function(t){function e(){var e=t.call(this)||this;return e.type="TopoSEdge",e}return r(e,t),e.prototype.render=function(t){var e=this.points,n=e[0],o=n.x,r=n.y,i=e[1],s=i.x,a=i.y;t.beginPath(),t.moveTo(o,r),t.lineTo(o,(r+a)/2),t.lineTo(s,(r+a)/2),t.lineTo(s,a),t.setLineDash(this.lineDash),t.lineWidth=this.lineWidth,t.strokeStyle=this.color,t.stroke(),t.closePath()},e.prototype.contain=function(t,e){for(var n=this.points[0],o=n.x,r=n.y,i=this.points[this.points.length-1],a=i.x,u=i.y,c=(r+u)/2,f=[[o,r],[o,c],[a,c],[a,u]],l=-1;++l<3;)if(s.default(f[l][0],f[l][1],f[l+1][0],f[l+1][1],t,e))return!0;return!1},e}(i.default);e.default=a},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(15),s=function(t){function e(){var e=t.call(this)||this;return e.type="TopoView",e.scale=1,e.width=500,e.height=400,e.backgroundColor="#f0f0f0",e.canvas=document.createElement("canvas"),e.ctx=e.canvas.getContext("2d"),e.canvas.width=500,e.canvas.height=400,e.canvas.style.width="500px",e.canvas.style.height="400px",e.canvas.style.verticalAlign="middle",i.default(e),e}return r(e,t),e.prototype.render=function(){var t=this;this.ctx.clearRect(0,0,this.width,this.height),this.ctx.fillStyle=this.backgroundColor,this.ctx.fillRect(0,0,this.width,this.height),this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.rotate(this.rotation/180*Math.PI),this.ctx.scale(this.scale,this.scale),this.elements.forEach((function(e){e.visible&&e.render(t.ctx)})),this.ctx.restore()},e.prototype.resize=function(t,e){this.width=t,this.height=e,this.canvas.width=t,this.canvas.height=e,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"},e.prototype.contain=function(t,e){return!0},e}(n(4).default);e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(16),r=n(4),i=n(0);e.default=function(t){var e,n,s,a=t.canvas,u=function(t,e,n){var r=new o.default(t,n.offsetX,n.offsetY);r.target=e[e.length-1],r.path=e,r.originalEvent=n,r.trigger()},c=[],f={contextmenu:function(t){t.preventDefault()},mousedown:function(t){n=!0,e=!1,u("mousedown",c,t)},mousemove:function(o){if(n)e?u("drag",c,o):(u("dragstart",c,o),e=!0);else{var s=c[c.length-1]||null;!function(e){var n=function(t,e,o){if(t instanceof i.default){var s=t.getRelativeCoord(e,o);e=s.x,o=s.y}t.contain(e,o)&&c.push(t),t instanceof r.default&&t.elements.forEach((function(t){return n(t,e,o)}))};c=[],n(t,e.offsetX,e.offsetY)}(o);var a=c[c.length-1];s===a?u("mousemove",c,o):(s&&u("mouseleave",[s],o),u("mouseenter",[a],o))}},mouseup:function(t){e?u("dragend",c,t):0===t.button?(0===s&&setTimeout((function(){2===s&&(u("dblclick",c,t),s=0)}),300),u("click",c,t),s++):2===t.button&&u("contextmenu",c,t),u("mouseup",c,t),e=!1,n=!1},mouseenter:function(t){u("mouseenter",c,t)},mouseleave:function(t){e=!1,n=!1,u("mouseleave",c,t)},mousewheel:function(t){t.preventDefault(),u("mousewheel",c,t)},DOMMouseScroll:function(t){t.preventDefault(),u("mousewheel",c,t)}};for(var l in f)a.addEventListener(l,f[l])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e,n){this.type=t,this.x=e,this.y=n,this._preventDefault=!1,this._stopPropagation=!1,this.target=null,this.path=[],this.originalEvent=null}return t.prototype.stopPropagation=function(){this._stopPropagation=!0},t.prototype.preventDefault=function(){this._preventDefault=!0},t.prototype.trigger=function(){for(var t=this.path.length;--t>-1&&(this.path[t].dispatch(this),!this._stopPropagation););},t}();e.default=o}]);